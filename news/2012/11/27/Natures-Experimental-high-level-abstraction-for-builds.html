
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Natures - Experimental high level abstraction for builds - SBuild</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Today, I will announce some very exciting development in SBuild land: Natures. For now, I have only a prototype, but looking onto what I have already, I am very excited to release it in a near future.">
        <meta name="author" content="">
    <meta name="keywords" content="">

	<!-- TWitter card -->
	<meta name="twitter:card" content="summary">
	<meta name="twitter:site" content="@SBuildOrg">
	<meta name="twitter:creator" content="@TobiasRoeser">
	       	<meta name="twitter:title" content="Natures - Experimental high level abstraction for builds">
		  <meta name="twitter:description" content="Today, I will announce some very exciting development in SBuild land: Natures. For now, I have only a prototype, but looking onto what I have already, I am very excited to release it in a near future.">
	  	

    <!-- Le styles -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/asciidoctor.css" rel="stylesheet">
    <link href="/css/base.css" rel="stylesheet">
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <link href="/css/bootstrap-responsive.min.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="/js/html5shiv.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="/assets/ico/apple-touch-icon-57-precomposed.png">-->
    <link rel="shortcut icon" href="/favicon.ico">
  </head>
  <body>
    <div id="wrap">
	
	<!-- Fixed navbar -->
      <div class="navbar navbar-fixed-top">
        <div class="navbar-inner">
          <div class="container">
            <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="brand" href="/">SBuild</a>
			<form class="navbar-form navbar-search pull-right" action="http://www.google.com/search">
                    <input type="text" name="q" class="search-query input-medium" placeholder="Google Search" />
                    <input type="hidden" name="sitesearch" value="sbuild.org" />
            </form>
            <div class="nav-collapse collapse">
              <ul class="nav pull-right">
                <li class="dropdown"><a href="/news">News</a>
                  <ul class="dropdown-menu" role="menu">
                                            <li><a href="/news/2014/12/17/SBuild-0.7.7-About-Thread-Deadlock-fixes-and-parallel-ClassLoaders-in-Scala.html">SBuild 0.7.7 - About Thread Deadlock fixes and parallel ClassLoaders in Scala <small class="muted">- 17 December 2014</small></a></li>
                        <li><a href="/news/2014/05/31/SBuild-0.7.6-ScalaDays-Hackathon-Release.html">SBuild 0.7.6 - ScalaDays Hackathon Release <small class="muted">- 31 May 2014</small></a></li>
                        <li><a href="/news/2014/05/09/SBuild-Eclipse-Plugin-0.4.3-released.html">SBuild Eclipse Plugin 0.4.3 released <small class="muted">- 09 May 2014</small></a></li>
                        <li><a href="/news/2014/04/04/SBuild-0.7.5-released.html">SBuild 0.7.5 released <small class="muted">- 04 April 2014</small></a></li>
                        <li><a href="/news/2014/03/20/SBuild-0.7.4-released.html">SBuild 0.7.4 released <small class="muted">- 20 March 2014</small></a></li>
                    <li><a href="/news">older News...</a><li>
                  </ul>
                </li>
                <li class="dropdown"><a href="/doc/sbuild">Documentation</a>
                  <ul class="dropdown-menu" role="menu">
                    <li><a href="/doc/sbuild/0.7.7"><i class="icon-book"></i> SBuild Reference Manual <span class="muted">0.7.7</span></a></li>
                    <li><a href="http://sbuild.org/uploads/sbuild/0.7.7/scaladoc/de.tototec.sbuild/#de.tototec.sbuild.package"><i class="icon-file-text"></i> SBuild Core ScalaDoc <span class="muted">0.7.7</span></a></li>
                    <li><a href="/releases"><i class="icon-calendar"></i> Release History</a></li>
                    <li><a href="/faq"><i class="icon-question-sign"></i> FAQ</a></li>
                  </ul>
                </li>
                <li class="dropdown"><a href="/download">Download</a>
                  <ul class="dropdown-menu" role="menu">
                    <li><a href="http://sbuild.org/uploads/sbuild/0.7.7/sbuild-0.7.7-dist.zip"><i class="icon-download-alt"></i> SBuild 0.7.7 Distribution <small class="muted">- 2014-12-17</small></a></li>
                  </ul>
                </li>
                <li><a href="/plugins.html">Plugins</a></li>
                <li><a href="/eclipse">Eclipse</a></li>
                <li class="dropdown">
                    <a href="/community.html">Get Involved / Contact</a>
                   <ul class="dropdown-menu" role="menu">
                    <li><a href="https://github.com/SBuild-org/sbuild"><i class="icon-github"></i> GitHub</a></li>
                    <li><a href="https://twitter.com/SBuildOrg"><i class="icon-twitter"></i> Twitter <small class="muted">@SBuildOrg</small></a></li>
                    <li><a href="https://gitter.im/SBuild-org/sbuild" ><i class="icon-comments"></i> Gitter</li>
<!--                    <li><a href="http://webchat.freenode.net/?channels=%23sbuild" ><i class="icon-comments"></i> IRC <small class="muted">#sbuild</small></a></li>
-->
                    <li><a href="https://groups.google.com/forum/#!forum/sbuild-dev"><i class="icon-envelope"></i> Developers <small class="muted">sbuild-dev</small></a></li>
                    <li><a href="https://groups.google.com/forum/#!forum/sbuild-user"><i class="icon-envelope"></i> User Forum <small class="muted">sbuild-user</small></a></li>
                  </ul>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div class="container">
	
	<div class="row">
	  <div class="span8">
	    <div class="page-header">
		  <h1>Natures - Experimental high level abstraction for builds</h1>
	    </div>

	    <p><em>27 November 2012 by Tobias Roeser</em></p>

		<p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Today, I will announce some very exciting development in SBuild land&#8230;</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="natures">Natures</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For now, I have only a prototype, but looking onto what I have already, I am very excited to release it in a near future.</p>
</div>
<div class="paragraph">
<p>Imagine, you could write a SBuild build file like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint scala language-scala"><code>class SBuild(implicit project: Project) {

  // Easy access to Maven Central repo
  SchemeHandler("mvn", new MvnSchemeHandler())

  // A compile classpath
  val compileCp =
    "mvn:org.scala-lang:scala-library:2.9.2" ~
    "mvn:org.slf4j:slf4j-api:1.7.2"

  // Define an artifact with some good default, that of course can be overridden
  val myArtifact =
    // implicitly adds a "clean" target
    new CleanNature
    // implicitly adds a "compileScala" target
    with CompileScalaNature
    // implicitly adds a "jar" target
    with JarNature
    {
      // here, we define the bare minimum, to get this example to work
      // a name, a version and the compile dependencies
      override def artifact_name = "org.example.myartifact"
      override def artifact_version = "1.0.0"
      override def compileScala_dependsOn = compileCp
    }

  // this will effectively create all targets implied by the configuration in this project
  myArtifact.createTargets

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>What looks like a whole lot of magic, is far from magic at all.
Each nature is a trait extending a Nature trait, potentially already providing some good defaults.
With a bit of naming policy, this is a very clean concept.
All the work does the compiler.
And, of course at no point you sacrify the control.
You can always write targets directly.
And, as you get the targets which you created with @Nature.createTargets@ as a return value, you can even extend or manipulate them further, e.g. by adding additional dependencies.</p>
</div>
<div class="paragraph">
<p>The output of <code>sbuild -l</code> of the above defined project:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>% sbuild -l
clean
compileScala
target/org.example.myartifact-1.0.0.jar</pre>
</div>
</div>
<div class="paragraph">
<p>The above buildscript is al that is needed to have a working compile, jar and clean target in a project.</p>
</div>
<div class="paragraph">
<p>Want have a look at the current internals?</p>
</div>
<div class="paragraph">
<p>Here are my current drafts for three of the obove used natures.</p>
</div>
<div class="sect2">
<h3 id="nature_trait">Nature trait</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint scala language-scala"><code>/**
 * To ensure, that it is always obvious where a def/val comes from, some naming policy is required.
 * Without, users would very fast have the feeling of magic and uncertainty.
 *
 * Also, as a best practice, when configuring your mixed natures,
 * you should always add the optional "overwrite" keyword when you intend to overwrite something.
 * That way, the compiler will understand your intend and can give a meaningful error message,
 * if for some reason there is no such def to override.
 *
 * Naming policy: Each nature should only define new methods in its own namespace.
 * Example: The Nature "MyOwnNature" should create all def's with the prefix "myOwn_", the "Nature" suffix should not be part of it.
 * Of course, "myOwn" would be also ok as a name, if only one def is needed and the name is already self describing,
 * like e.g. "OutputDirNature" and the def "outputDir".
 *
 */
trait Nature {

  /**
   * Create target(s) in the scope of the given (implicit) project.
   * Any implementation has to take care of calling super.createTargets.
   */
  def createTargets(implicit project: Project): Seq[Target] = Seq()

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="outputdirnature_trait">OutputDirNature trait</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint scala language-scala"><code>/**
 * Basic nature, configuring an output directory.
 */
trait OutputDirNature extends Nature {
  /**
   * The primary output directory.
   */
  def outputDir: String = "target"
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="cleannature_trait">CleanNature trait</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint scala language-scala"><code>/**
 * Nature adding a "clean" target which removes an output directory.
 */
trait CleanNature extends OutputDirNature {
  /**
   * The target name.
   */
  def clean_targetName: String = "clean"

  // add a new target "phony:clean" which utilizes Ant delete task to remove the dir defined in OutputDirNature.outputDir
  abstract override def createTargets(implicit project: Project) = super.createTargets(project) ++
    Seq(Target("phony:" + clean_targetName) exec {
      AntDelete(dir = Path(outputDir))
    })
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, no magic at all.
The <code>createTargets</code> methods create normal targets.
Pure Scala mixins on top of an already powerful buildsystem.</p>
</div>
<div class="paragraph">
<p>Stay tuned,</p>
</div>
<div class="paragraph">
<p>Tobias</p>
</div>
</div>
</div>
</div></p>
		
		
	    <ul class="pager">
		    <li class="previous"><a href="/news/2012/10/31/SBuild-Eclipse-Plugin-0.2.0.html">&larr; Older</a></li>
		    <li><a href="/news">List all news items</a></li>
		    <li class="next"><a href="/news/2013/01/26/SBuild-0.3.2-released.html">Newer &rarr;</a></li>
		</ul>
	    
	        <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'sbuild'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
      </div>
      <div class="span4">
	    <h1><small>Recent News</small></h1>
	    
			<h3><small>December 2014</small></h3>
			<ul>
		
		<li>17 - <a href="/news/2014/12/17/SBuild-0.7.7-About-Thread-Deadlock-fixes-and-parallel-ClassLoaders-in-Scala.html">SBuild 0.7.7 - About Thread Deadlock fixes and parallel ClassLoaders in Scala</a></li>
				</ul>
				<h3><small>May 2014</small></h3>
				<ul>
		
		<li>31 - <a href="/news/2014/05/31/SBuild-0.7.6-ScalaDays-Hackathon-Release.html">SBuild 0.7.6 - ScalaDays Hackathon Release</a></li>
		
		<li>09 - <a href="/news/2014/05/09/SBuild-Eclipse-Plugin-0.4.3-released.html">SBuild Eclipse Plugin 0.4.3 released</a></li>
				</ul>
				<h3><small>April 2014</small></h3>
				<ul>
		
		<li>04 - <a href="/news/2014/04/04/SBuild-0.7.5-released.html">SBuild 0.7.5 released</a></li>
				</ul>
				<h3><small>March 2014</small></h3>
				<ul>
		
		<li>20 - <a href="/news/2014/03/20/SBuild-0.7.4-released.html">SBuild 0.7.4 released</a></li>
		
		<li>18 - <a href="/news/2014/03/18/SBuild-0.7.3-released.html">SBuild 0.7.3 released</a></li>
		
		<li>06 - <a href="/news/2014/03/06/SBuild-0.7.2-released.html">SBuild 0.7.2 released</a></li>
				</ul>
				<h3><small>February 2014</small></h3>
				<ul>
		
		<li>11 - <a href="/news/2014/02/11/Issue-Tracker-moved-to-GitHub.html">Issue Tracker moved to GitHub</a></li>
				</ul>
				<h3><small>December 2013</small></h3>
				<ul>
		
		<li>20 - <a href="/news/2013/12/20/SBuild-0.7.1-released.html">SBuild 0.7.1 released</a></li>
		
		<li>20 - <a href="/news/2013/12/20/The-Plugin-System-of-SBuild-0.7.1.html">The Plugin System of SBuild 0.7.1</a></li>
		
		<li>06 - <a href="/news/2013/12/06/Jenkins-Plugin-for-SBuild-available.html">Jenkins Plugin for SBuild available</a></li>
		
		<li>06 - <a href="/news/2013/12/06/SBuild-0.7.0-released.html">SBuild 0.7.0 released</a></li>
		
		<li>06 - <a href="/news/2013/12/06/The-Plugin-System-of-SBuild-0.7.0.html">The Plugin System of SBuild 0.7.0</a></li>
		
		<li>03 - <a href="/news/2013/12/03/All-SBuild-repositories-are-now-hosted-on-GitHub.html">All SBuild repositories are now hosted on GitHub</a></li>
				</ul>
				<h3><small>November 2013</small></h3>
				<ul>
		
		<li>21 - <a href="/news/2013/11/21/SBuild-switched-to-Git.html">SBuild switched to Git</a></li>
				</ul>
				<h3><small>September 2013</small></h3>
				<ul>
		
		<li>19 - <a href="/news/2013/09/19/SBuild-0.6.0-released.html">SBuild 0.6.0 released</a></li>
				</ul>
				<h3><small>July 2013</small></h3>
				<ul>
		
		<li>12 - <a href="/news/2013/07/12/SBuild-0.5.0-New-and-Noteworthy.html">New and Noteworthy of SBuild 0.5.0</a></li>
		
		<li>12 - <a href="/news/2013/07/12/SBuild-0.5.0-Released.html">SBuild 0.5.0 Released</a></li>
				</ul>
				<h3><small>April 2013</small></h3>
				<ul>
		
		<li>29 - <a href="/news/2013/04/29/SBuild-Eclipse-Plugin-0.4.1.html">SBuild Eclipse Plugin 0.4.1</a></li>
		
		<li>20 - <a href="/news/2013/04/20/SBuild-Eclipse-Plugin-0.4.0-Hackathon-Release.html">SBuild Eclipse Plugin 0.4.0 - Hackathon Release</a></li>
				</ul>
				<h3><small>March 2013</small></h3>
				<ul>
		
		<li>11 - <a href="/news/2013/03/11/SBuild-0.4.0-Released.html">SBuild 0.4.0 Released</a></li>
		
		<li>07 - <a href="/news/2013/03/07/Attached-Files-and-Alias-Schemes-in-SBuild-0.4.html">Attached Files and Alias Schemes in SBuild 0.4</a></li>
				</ul>
				<h3><small>February 2013</small></h3>
				<ul>
		
		<li>23 - <a href="/news/2013/02/23/Target-caching-in-SBuild-0.4.html">Target caching in SBuild 0.4</a></li>
				</ul>
				<h3><small>January 2013</small></h3>
				<ul>
		
		<li>26 - <a href="/news/2013/01/26/SBuild-0.3.2-released.html">SBuild 0.3.2 released</a></li>
				</ul>
				<h3><small>November 2012</small></h3>
				<ul>
		
		<li>27 - <a href="/news/2012/11/27/Natures-Experimental-high-level-abstraction-for-builds.html">Natures - Experimental high level abstraction for builds</a></li>
				</ul>
				<h3><small>October 2012</small></h3>
				<ul>
		
		<li>31 - <a href="/news/2012/10/31/SBuild-Eclipse-Plugin-0.2.0.html">SBuild Eclipse Plugin 0.2.0</a></li>
		
		<li>29 - <a href="/news/2012/10/29/SBuild-Eclipse-Plugin-0.2.0-release-comming-soon.html">SBuild Eclipse Plugin 0.2.0 release comming soon</a></li>
		
		<li>23 - <a href="/news/2012/10/23/Managing-Eclipse-Build-Path-Entries-with-SBuild.html">Managing Eclipse Build Path Entries with SBuild</a></li>
				</ul>
				<h3><small>September 2012</small></h3>
				<ul>
		
		<li>26 - <a href="/news/2012/09/26/SBuild-0.1.1-Released.html">SBuild 0.1.1 Released</a></li>
				</ul>
				<h3><small>July 2012</small></h3>
				<ul>
		
		<li>29 - <a href="/news/2012/07/29/SBuild-0.1.0-First-Public-Release.html">SBuild 0.1.0 First Public Release</a></li>
		
		<li>12 - <a href="/news/2012/07/12/Preparations-for-first-release.html">Preparations for first release</a></li>
	    
	    </ul>
	    
	  </div>

	<hr>
	
		</div>
		<div id="push"></div>
    </div>
    
    
    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/js/jquery-1.9.1.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/run_prettify.js"></script>
    
  </body>
</html>