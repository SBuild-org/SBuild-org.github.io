
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>The Plugin System of SBuild 0.7.0 - SBuild</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="With the 0.7.0 release, SBuild received a plugin system. We will show you, how it looks like.">
        <meta name="author" content="">
    <meta name="keywords" content="">

	<!-- TWitter card -->
	<meta name="twitter:card" content="summary">
	<meta name="twitter:site" content="@SBuildOrg">
	<meta name="twitter:creator" content="@TobiasRoeser">
	       	<meta name="twitter:title" content="The Plugin System of SBuild 0.7.0">
		  <meta name="twitter:description" content="With the 0.7.0 release, SBuild received a plugin system. We will show you, how it looks like.">
	  	

    <!-- Le styles -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/asciidoctor.css" rel="stylesheet">
    <link href="/css/base.css" rel="stylesheet">
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <link href="/css/bootstrap-responsive.min.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="/js/html5shiv.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="/assets/ico/apple-touch-icon-57-precomposed.png">-->
    <link rel="shortcut icon" href="/favicon.ico">
  </head>
  <body>
    <div id="wrap">
	
	<!-- Fixed navbar -->
      <div class="navbar navbar-fixed-top">
        <div class="navbar-inner">
          <div class="container">
            <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="brand" href="/">SBuild</a>
			<form class="navbar-form navbar-search pull-right" action="http://www.google.com/search">
                    <input type="text" name="q" class="search-query input-medium" placeholder="Google Search" />
                    <input type="hidden" name="sitesearch" value="sbuild.org" />
            </form>
            <div class="nav-collapse collapse">
              <ul class="nav pull-right">
                <li class="dropdown"><a href="/news">News</a>
                  <ul class="dropdown-menu" role="menu">
                                            <li><a href="/news/2014/12/17/SBuild-0.7.7-About-Thread-Deadlock-fixes-and-parallel-ClassLoaders-in-Scala.html">SBuild 0.7.7 - About Thread Deadlock fixes and parallel ClassLoaders in Scala <small class="muted">- 17 December 2014</small></a></li>
                        <li><a href="/news/2014/05/31/SBuild-0.7.6-ScalaDays-Hackathon-Release.html">SBuild 0.7.6 - ScalaDays Hackathon Release <small class="muted">- 31 May 2014</small></a></li>
                        <li><a href="/news/2014/05/09/SBuild-Eclipse-Plugin-0.4.3-released.html">SBuild Eclipse Plugin 0.4.3 released <small class="muted">- 09 May 2014</small></a></li>
                        <li><a href="/news/2014/04/04/SBuild-0.7.5-released.html">SBuild 0.7.5 released <small class="muted">- 04 April 2014</small></a></li>
                        <li><a href="/news/2014/03/20/SBuild-0.7.4-released.html">SBuild 0.7.4 released <small class="muted">- 20 March 2014</small></a></li>
                    <li><a href="/news">older News...</a><li>
                  </ul>
                </li>
                <li class="dropdown"><a href="/doc/sbuild">Documentation</a>
                  <ul class="dropdown-menu" role="menu">
                    <li><a href="/doc/sbuild/0.7.7"><i class="icon-book"></i> SBuild Reference Manual <span class="muted">0.7.7</span></a></li>
                    <li><a href="http://sbuild.org/uploads/sbuild/0.7.7/scaladoc/de.tototec.sbuild/#de.tototec.sbuild.package"><i class="icon-file-text"></i> SBuild Core ScalaDoc <span class="muted">0.7.7</span></a></li>
                    <li><a href="/releases"><i class="icon-calendar"></i> Release History</a></li>
                    <li><a href="/faq"><i class="icon-question-sign"></i> FAQ</a></li>
                  </ul>
                </li>
                <li class="dropdown"><a href="/download">Download</a>
                  <ul class="dropdown-menu" role="menu">
                    <li><a href="http://sbuild.org/uploads/sbuild/0.7.7/sbuild-0.7.7-dist.zip"><i class="icon-download-alt"></i> SBuild 0.7.7 Distribution <small class="muted">- 2014-12-17</small></a></li>
                  </ul>
                </li>
                <li><a href="/plugins.html">Plugins</a></li>
                <li><a href="/eclipse">Eclipse</a></li>
                <li class="dropdown">
                    <a href="/community.html">Get Involved / Contact</a>
                   <ul class="dropdown-menu" role="menu">
                    <li><a href="https://github.com/SBuild-org/sbuild"><i class="icon-github"></i> GitHub</a></li>
                    <li><a href="https://twitter.com/SBuildOrg"><i class="icon-twitter"></i> Twitter <small class="muted">@SBuildOrg</small></a></li>
                    <li><a href="https://gitter.im/SBuild-org/sbuild" ><i class="icon-comments"></i> Gitter</li>
<!--                    <li><a href="http://webchat.freenode.net/?channels=%23sbuild" ><i class="icon-comments"></i> IRC <small class="muted">#sbuild</small></a></li>
-->
                    <li><a href="https://groups.google.com/forum/#!forum/sbuild-dev"><i class="icon-envelope"></i> Developers <small class="muted">sbuild-dev</small></a></li>
                    <li><a href="https://groups.google.com/forum/#!forum/sbuild-user"><i class="icon-envelope"></i> User Forum <small class="muted">sbuild-user</small></a></li>
                  </ul>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div class="container">
	
	<div class="row">
	  <div class="span8">
	    <div class="page-header">
		  <h1>The Plugin System of SBuild 0.7.0</h1>
	    </div>

	    <p><em>06 December 2013 by Tobias Roeser</em></p>

		<p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>With the <a href="/releases/SBuild-0.7.0.html">0.7.0</a> release, SBuild received a plugin system.
Although, it is not necessary to implement a plugin to provide features to SBuild,
writing a plugin might provide some useful characteristic not available otherwise.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="exported_and_private_packages">Exported and private packages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Each SBuild plugin is loaded by a separate classloader and has the capability to keep its implementation (and dependencies) private.
On the other hand, a plugin can export some or all of its internals on a package level (just like in OSGi).
Thus, with plugins, you have fine control over what a plugin will contribute to a SBuild project.
It is intended, that plugins with lots of dependencies keep those in their private classes space to avoid conflicts with other plugins and the project itself.
At a minimum the plugin class must be exported.
All other classes, even the plugin factory (the class implementing the <code>Plugin</code> trait) can be private.</p>
</div>
<div class="paragraph">
<p>To make an plugin available to your project, all you need to do is to add it to the classpath of the project, e.g. with the <code>@classpath</code> annotation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="no_magic_just_what_you_call_for">No magic, just what you call for</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Another focus was it, to keep SBuild magic free (tm) and the user in full control.
Thus, no plugin will automatically extend or modify your project (besides the classpath).
To use some plugins functionality, you have to explicitly activate it.</p>
</div>
<div class="paragraph">
<p>At any point in your SBuild buildfile you can activate and configure a plugin.
Based on that configuration, the plugin will contribute additional functionality to your project, which contains most likely a new Target or a SchemeHandler.
E.g. a Java compiler plugin might provide a target that compiles your Java source files
whereas a Aether plugin would add a SchemeHandler that is able to resolve transitive dependencies through the Eclipse Aether (aka Maven) library.</p>
</div>
<div class="paragraph">
<p>For more flexibility each plugin can have multiple instances which are named.
In most cases you will not need this feature and you simple can leave the name out (the plugin instance will become the name <code>""</code>).
This feature should support scenarios like using the same compile plugin to compile main and test classes,
or use the same test runner plugin to run unit tests and integration tests.
As the plugin instances are aware of their given name, some good defaults could be derived from that name.
E.g. a compiler plugin instance with the name "test" could automatically adjust the target name and input and output directories.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="example_hello_world_plugin">Example Hello World Plugin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Imagine a simple <code>Hello</code> plugin, which will add a <code>"hello"</code> target to our project.
If the plugin instance is named, the target name will be <code>"hello-${name}"</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint scala language-scala"><code>import de.tototec.sbuild._
import org.example.hello

@version("0.7.0")
@classpath("mvn:org.example:helloworld:1.0.0") <i class="conum" data-value="1"></i><b>(1)</b>
class SBuild(implicit _project: Project) {

  Plugin[Hello] <i class="conum" data-value="2"></i><b>(2)</b>

  Plugin[Hello]("world") <i class="conum" data-value="3"></i><b>(3)</b>

  Plugin[Hello]("city") configure { c =&gt; <i class="conum" data-value="4"></i><b>(4)</b>
    c.targetName = "hello-town"
  }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>With the <code>@classpath</code> annotation, we make the plugin available in our buildfile.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>With the <code>Plugin.apply[T]</code> method, we activate the plugin with it&#8217;s default configuration.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We activate another plugin instance, but this time a named instance with the name <code>"world"</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Here, we activate another <code>"city"</code> instance an configure it.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The such configured project will have three targets:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>bash $ sbuild -l
hello
hello-world
hello-town</pre>
</div>
</div>
<div class="paragraph">
<p>The implementation of that plugin could look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint scala language-scala"><code>package org.example.hello

import de.tototec.sbuild._

// This is the class that is seen in the project buildfile and is used for configuration
class Hello(val name: String) {
  var targetName: String = if(name == "") "hello" else s"hello-$name"
}

// This is the factory
class HelloPlugin(implicit project: Project) extends Plugin[Hello] {
  override def create(name: String): Hello = new Hello(name)
  override def applyToProject(instances: Seq[(String, Hello)]): Unit = instances foreach {
    case (name, hello) =&gt;
      Target(hello.targetName) exec {
        println("hello " + hello.name)
      }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Jar, that contains the hello plugin must at least have the following Manifest entry:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SBuild-Plugin: org.example.hello.Hello=org.example.hello.HelloPlugin;version="1.0.0"</pre>
</div>
</div>
<div class="paragraph">
<p>The supported Manifest entries are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>SBuild-Plugin</code> - Used to declare one or more plugins.</p>
</li>
<li>
<p><code>SBuild-Classpath</code> - Used to add additional dependencies (as part of the private class space). All default SBuild schemes (file, http, mvn) are supported.</p>
</li>
<li>
<p><code>SBuild-ExportPackage</code> - Used to export some of the plugins private packages. If this is not present, all packages of that plugin will be exported.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="and_the_not_so_shiny_parts">&#8230;and the not so shiny parts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Unfortunately the resources to develop SBuild are limited and the main focus for this release was to get a minimal working plugin system right,
so that you and me can start to write plugins.
Currently, there are almost no ready to use plugins available.
Another drawback is the spare documentation for the plugin system and SBuild in general.
I will try hard to improve that part, too.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="outlook">Outlook</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Of course, there will be more plugins over time.
We will provide some, other will hopefully too.
Also, there is some ongoing thinking, that we should organize a plugin hackathon in January 2014 in Leipzig.</p>
</div>
<div class="paragraph">
<p>Our aim is to build an open community and we look forward to your plugins and your feedback.
Let us know if you use SBuild, too.
Please use the channel most appropriate for you, email, twitter, forum, ticket system, mailing list, its your choice.</p>
</div>
<div class="paragraph">
<p>The plugin system is just one new part of SBuild 0.7.0. I hope, you enjoy all the other improvements too.</p>
</div>
</div>
</div></p>
		
		
	    <ul class="pager">
		    <li class="previous"><a href="/news/2013/12/03/All-SBuild-repositories-are-now-hosted-on-GitHub.html">&larr; Older</a></li>
		    <li><a href="/news">List all news items</a></li>
		    <li class="next"><a href="/news/2013/12/06/SBuild-0.7.0-released.html">Newer &rarr;</a></li>
		</ul>
	    
	        <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'sbuild'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
      </div>
      <div class="span4">
	    <h1><small>Recent News</small></h1>
	    
			<h3><small>December 2014</small></h3>
			<ul>
		
		<li>17 - <a href="/news/2014/12/17/SBuild-0.7.7-About-Thread-Deadlock-fixes-and-parallel-ClassLoaders-in-Scala.html">SBuild 0.7.7 - About Thread Deadlock fixes and parallel ClassLoaders in Scala</a></li>
				</ul>
				<h3><small>May 2014</small></h3>
				<ul>
		
		<li>31 - <a href="/news/2014/05/31/SBuild-0.7.6-ScalaDays-Hackathon-Release.html">SBuild 0.7.6 - ScalaDays Hackathon Release</a></li>
		
		<li>09 - <a href="/news/2014/05/09/SBuild-Eclipse-Plugin-0.4.3-released.html">SBuild Eclipse Plugin 0.4.3 released</a></li>
				</ul>
				<h3><small>April 2014</small></h3>
				<ul>
		
		<li>04 - <a href="/news/2014/04/04/SBuild-0.7.5-released.html">SBuild 0.7.5 released</a></li>
				</ul>
				<h3><small>March 2014</small></h3>
				<ul>
		
		<li>20 - <a href="/news/2014/03/20/SBuild-0.7.4-released.html">SBuild 0.7.4 released</a></li>
		
		<li>18 - <a href="/news/2014/03/18/SBuild-0.7.3-released.html">SBuild 0.7.3 released</a></li>
		
		<li>06 - <a href="/news/2014/03/06/SBuild-0.7.2-released.html">SBuild 0.7.2 released</a></li>
				</ul>
				<h3><small>February 2014</small></h3>
				<ul>
		
		<li>11 - <a href="/news/2014/02/11/Issue-Tracker-moved-to-GitHub.html">Issue Tracker moved to GitHub</a></li>
				</ul>
				<h3><small>December 2013</small></h3>
				<ul>
		
		<li>20 - <a href="/news/2013/12/20/SBuild-0.7.1-released.html">SBuild 0.7.1 released</a></li>
		
		<li>20 - <a href="/news/2013/12/20/The-Plugin-System-of-SBuild-0.7.1.html">The Plugin System of SBuild 0.7.1</a></li>
		
		<li>06 - <a href="/news/2013/12/06/Jenkins-Plugin-for-SBuild-available.html">Jenkins Plugin for SBuild available</a></li>
		
		<li>06 - <a href="/news/2013/12/06/SBuild-0.7.0-released.html">SBuild 0.7.0 released</a></li>
		
		<li>06 - <a href="/news/2013/12/06/The-Plugin-System-of-SBuild-0.7.0.html">The Plugin System of SBuild 0.7.0</a></li>
		
		<li>03 - <a href="/news/2013/12/03/All-SBuild-repositories-are-now-hosted-on-GitHub.html">All SBuild repositories are now hosted on GitHub</a></li>
				</ul>
				<h3><small>November 2013</small></h3>
				<ul>
		
		<li>21 - <a href="/news/2013/11/21/SBuild-switched-to-Git.html">SBuild switched to Git</a></li>
				</ul>
				<h3><small>September 2013</small></h3>
				<ul>
		
		<li>19 - <a href="/news/2013/09/19/SBuild-0.6.0-released.html">SBuild 0.6.0 released</a></li>
				</ul>
				<h3><small>July 2013</small></h3>
				<ul>
		
		<li>12 - <a href="/news/2013/07/12/SBuild-0.5.0-New-and-Noteworthy.html">New and Noteworthy of SBuild 0.5.0</a></li>
		
		<li>12 - <a href="/news/2013/07/12/SBuild-0.5.0-Released.html">SBuild 0.5.0 Released</a></li>
				</ul>
				<h3><small>April 2013</small></h3>
				<ul>
		
		<li>29 - <a href="/news/2013/04/29/SBuild-Eclipse-Plugin-0.4.1.html">SBuild Eclipse Plugin 0.4.1</a></li>
		
		<li>20 - <a href="/news/2013/04/20/SBuild-Eclipse-Plugin-0.4.0-Hackathon-Release.html">SBuild Eclipse Plugin 0.4.0 - Hackathon Release</a></li>
				</ul>
				<h3><small>March 2013</small></h3>
				<ul>
		
		<li>11 - <a href="/news/2013/03/11/SBuild-0.4.0-Released.html">SBuild 0.4.0 Released</a></li>
		
		<li>07 - <a href="/news/2013/03/07/Attached-Files-and-Alias-Schemes-in-SBuild-0.4.html">Attached Files and Alias Schemes in SBuild 0.4</a></li>
				</ul>
				<h3><small>February 2013</small></h3>
				<ul>
		
		<li>23 - <a href="/news/2013/02/23/Target-caching-in-SBuild-0.4.html">Target caching in SBuild 0.4</a></li>
				</ul>
				<h3><small>January 2013</small></h3>
				<ul>
		
		<li>26 - <a href="/news/2013/01/26/SBuild-0.3.2-released.html">SBuild 0.3.2 released</a></li>
				</ul>
				<h3><small>November 2012</small></h3>
				<ul>
		
		<li>27 - <a href="/news/2012/11/27/Natures-Experimental-high-level-abstraction-for-builds.html">Natures - Experimental high level abstraction for builds</a></li>
				</ul>
				<h3><small>October 2012</small></h3>
				<ul>
		
		<li>31 - <a href="/news/2012/10/31/SBuild-Eclipse-Plugin-0.2.0.html">SBuild Eclipse Plugin 0.2.0</a></li>
		
		<li>29 - <a href="/news/2012/10/29/SBuild-Eclipse-Plugin-0.2.0-release-comming-soon.html">SBuild Eclipse Plugin 0.2.0 release comming soon</a></li>
		
		<li>23 - <a href="/news/2012/10/23/Managing-Eclipse-Build-Path-Entries-with-SBuild.html">Managing Eclipse Build Path Entries with SBuild</a></li>
				</ul>
				<h3><small>September 2012</small></h3>
				<ul>
		
		<li>26 - <a href="/news/2012/09/26/SBuild-0.1.1-Released.html">SBuild 0.1.1 Released</a></li>
				</ul>
				<h3><small>July 2012</small></h3>
				<ul>
		
		<li>29 - <a href="/news/2012/07/29/SBuild-0.1.0-First-Public-Release.html">SBuild 0.1.0 First Public Release</a></li>
		
		<li>12 - <a href="/news/2012/07/12/Preparations-for-first-release.html">Preparations for first release</a></li>
	    
	    </ul>
	    
	  </div>

	<hr>
	
		</div>
		<div id="push"></div>
    </div>
    
    
    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/js/jquery-1.9.1.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/run_prettify.js"></script>
    
  </body>
</html>